
FROM codenvy/jdk8_maven3_tomcat8

COPY --chown=user:user files /

RUN sudo su -c "echo 'deb [check-valid-until=no] http://cdn-fastly.deb.debian.org/debian jessie main' > /etc/apt/sources.list.d/jessie.list"
RUN sudo su -c "echo 'deb [check-valid-until=no] http://archive.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list"
RUN sudo su -c "sed -i '/deb http:\/\/deb.debian.org\/debian jessie-updates main/d' /etc/apt/sources.list"
RUN sudo apt-get -o Acquire::Check-Valid-Until=false update

RUN sudo apt-get update -y && sudo apt-get -yq --force-yes install python3 netcat vim tcpdump

USER user

WORKDIR /home/user

RUN cd rmi-poc && \
    javac -cp catalina.jar:. RMIServerPOC.java

EXPOSE 22/tcp 

CMD ["/entrypoint.sh"]
